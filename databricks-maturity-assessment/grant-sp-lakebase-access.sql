-- Grant service principal access to Lakebase
-- Service Principal ID: 2dd066d2-2717-4694-85be-968a1407fd53

-- Create the role with OAuth security label
CREATE ROLE "2dd066d2-2717-4694-85be-968a1407fd53" WITH LOGIN;

-- Set the security label for OAuth authentication
SECURITY LABEL FOR databricks ON ROLE "2dd066d2-2717-4694-85be-968a1407fd53" IS '2dd066d2-2717-4694-85be-968a1407fd53';

-- Grant all privileges
GRANT ALL PRIVILEGES ON DATABASE databricks_postgres TO "2dd066d2-2717-4694-85be-968a1407fd53";
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO "2dd066d2-2717-4694-85be-968a1407fd53";
GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA public TO "2dd066d2-2717-4694-85be-968a1407fd53";
GRANT USAGE ON SCHEMA public TO "2dd066d2-2717-4694-85be-968a1407fd53";
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON TABLES TO "2dd066d2-2717-4694-85be-968a1407fd53";
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON SEQUENCES TO "2dd066d2-2717-4694-85be-968a1407fd53";


